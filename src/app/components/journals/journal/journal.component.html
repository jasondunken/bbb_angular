<div class="journal-page">
    <div class="journal-component" *ngIf="journal">
        <div class="button round-button" (click)="backToJournals()">
            <mat-icon matTooltip="return to journals" matTooltipPosition="right">arrow_back</mat-icon>
        </div>
        <h1>{{ journal.name }}</h1>
        <h2>{{ journal.description }}</h2>
        <div *ifRoles="['admin']">
            <div class="button round-button" (click)="createEntry()" *ngIf="!creatingEntry">
                <mat-icon matTooltip="add a new journal entry" matTooltipPosition="right">add</mat-icon>
            </div>
            <div class="create-journal-entry-component" *ngIf="creatingEntry" [formGroup]="journalEntryForm">
                <h2 class="section-title">New Journal Entry</h2>

                <div class="editor-component">
                    <label for="entryTitle"><h3>Title</h3></label>
                    <input name="entryTitle" type="text" formControlName="title" />
                    <label for="entryBody"><h3>Body</h3></label>
                    <div class="editor-content-panel">
                        <div class="editor-select-bar">
                            <div
                                class="button editor-select-button"
                                [class.editor-button-selected]="editingEntry"
                                (click)="editEntry()"
                            >
                                Edit
                            </div>
                            <div
                                class="button editor-select-button"
                                [class.editor-button-selected]="!editingEntry"
                                (click)="previewEntry()"
                            >
                                Preview
                            </div>
                        </div>
                        <textarea
                            *ngIf="editingEntry"
                            class="journal-entry-textarea"
                            name="entryBody"
                            formControlName="body"
                        ></textarea>
                        <div *ngIf="!editingEntry" class="journal-entry-preview" [innerHtml]="entryPreviewHtml"></div>
                    </div>
                </div>

                <div *ngIf="addingImage" class="add-image-component">
                    <label for="imagePicker" class=""><h2 class="section-title">Select Image</h2></label>
                    <input type="file" name="imagePicker" (change)="selectImageFile($event)" />
                    <label for="imageName"><h3>Image Name</h3></label>
                    <input type="text" name="imageName" />
                    <div class="button-bar">
                        <div class="button round-button" matTooltip="upload image" (click)="uploadImage()">
                            <mat-icon>save</mat-icon>
                        </div>
                        <div class="button round-button" matTooltip="cancel" (click)="cancelAddImage()">
                            <mat-icon>cancel</mat-icon>
                        </div>
                    </div>
                </div>

                <div class="button-bar">
                    <div
                        *ngIf="!addingImage"
                        class="button round-button"
                        matTooltip="add an image"
                        (click)="addImage()"
                    >
                        <mat-icon>image</mat-icon>
                    </div>
                    <div class="button round-button" matTooltip="upload journal entry" (click)="saveEntry()">
                        <mat-icon>save</mat-icon>
                    </div>
                    <div class="button round-button" matTooltip="cancel" (click)="cancel()">
                        <mat-icon>cancel</mat-icon>
                    </div>
                </div>
            </div>
        </div>
        <div class="journal-entry" *ngFor="let entry of journalEntries">
            <h2>{{ entry.title }}</h2>
            <h4>{{ formatDate(entry.createdAt) }}</h4>
            <p [innerHtml]="entry.body"></p>
        </div>
    </div>
</div>
